## Inode-FS
	- Layers
		- Block Layer:
			- 4KB Size per block (maybe but adjustable)
			- Contains bitmap to track the usability of the block
			  id:: 654f666b-a243-49f6-8077-f1324f3092b4
		- File Layer:
			- **Representative**: Inode
			- Resides in the block too. Holds the location where real data stores and the file's **metadata**.
			- ![image.png](../assets/image_1699702663883_0.png)
			- Indirect holds another map to block which holds other indirect blocks
			- Only the direct block holds the real data block which stores the actual data
		- Inode number layer
			- Just an array stores behind the block bitmap's with also inode's bitmap
			- Indicates the block number of the inode layer
		- File Name Layer
			- Hide metadata of file management
			- Separate the directory type and regular file type
			- Holds the mapping from the filename to the inode number.
		- Path Name Layer
			- ![image.png](../assets/image_1699703268122_0.png)
			- Recursively look up the directory inode untils it lands on the regular files.
			- The inode number of the root directory is fixed. In the case of the ext4, it's assigned with 1. Note that we don't have number 0 here, since it represents the dysfunction of the file system.
	- ### Links
		- ![image.png](../assets/image_1699790498209_0.png)
		- Two semantic abstractions
			- LINK (from, to) --- to's name to from's inode
			- UNLINK (name) --- decrease the reference count of the inode where name points to.
		- Create Shortcut from one link to another.
		- We store the reference count inside the inode.
		- We increment the refcnt of the inode if one link is formed. The default is always one.
		- When the reference count of the inode reaches zero, we can safely remove the inode and free the data blocks.
	- #### Renaming(from,to)
		- When renaming, it should be guaranteed that LINK(from, to) is done atomically and should not fail.
	- #### Two Types of lINKS
		- Soft Link --- only associates the destination with the name
		- Hard Link --- associates the destination with the inode number
	-
- ## FAT System
	- **Only Two Layers**
		- File associated entry
			- starting from the root and finds the first block of the backed file and traverse the linked list.
		- Free List
			- contains the free block number and perform allocation and garbage collecting based on this free list.
		- ![image.png](../assets/image_1699791405135_0.png)
		- Linked List Structure
			- Point to the end of the block list when ended.
		- Directory
			- Hold the next file entry until it reaches the end.
			- Hold the metadata of the file and the entry of another file/directory.
			- ![image.png](../assets/image_1699792373187_0.png)
		- Advantage:
			- Naive and simple --- used as the supporting file system for efi when designing the UEFI boot system
- ## File System Abstraction
	- ### Open
		- Gives the process a fd in its own fd table which points to an entry in the file table
		- Each process has its own fd table but shares the file entry table on the OS level
		- One open increase the reference count of the file table entry and the file itself,  each child process will increase also
		- However, another open will get to another entry separating the file cursor apart from each other
	- ### Close
		- Remove the fd table entry from the process
		- Decrement the reference count of the file table entry
		- Remove the file table entry if the reference count reaches zero
	- ### Read
		- Move the file cursor and read the data block.
		- Update the **Access** time (which means write operation )of itself and its all ancestors recursively (Can be disabled via system-level noatime mount)
	- ### Write/Append (No need to mention here)
	- ### Sync
		- Flush the page cache
	-
	-
- ## Network File System
-
- ## Consistency Models
-
- ## All or Nothing? Logging
-
- ## Core of transaction and block atomicity -- 2PL and OCC
-
- ##
-